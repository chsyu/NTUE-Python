{"ast":null,"code":"import { SET_PAGE_TITLE, SET_PAGE_CONTENT, SET_NAVBAR_ACTIVEITEM, ADD_CART_ITEM, REMOVE_CART_ITEM, SET_PRODUCT_DETAIL, BEGIN_PRODUCTS_REQUEST, SUCCESS_PRODUCTS_REQUEST, FAIL_PRODUCTS_REQUEST, BEGIN_LOGIN_REQUEST, SUCCESS_LOGIN_REQUEST, FAIL_LOGIN_REQUEST, BEGIN_REGISTER_REQUEST, SUCCESS_REGISTER_REQUEST, FAIL_REGISTER_REQUEST, BEGIN_UPDATE_USERINFO, SUCCESS_UPDATE_USERINFO, FAIL_UPDATE_USERINFO, LOGOUT_REQUEST, REMEMBER_LOGIN, BEGIN_ORDER_CREATE, SUCCESS_ORDER_CREATE, FAIL_ORDER_CREATE, SAVE_SHIPPING_ADDRESS, SAVE_PAYMENT_METHOD, RESET_ORDER, BEGIN_ORDER_DETAIL, SUCCESS_ORDER_DETAIL, FAIL_ORDER_DETAIL } from \"../utils/constants\";\nimport { getProducts, getProductById, signInWithEmailPassword, registerWithEmailPassword, updateProfile, createOrderApi, getOrderById } from \"../api\";\nexport const addCartItem = (dispatch, product, qty) => {\n  const item = {\n    id: product.id,\n    category: product.category,\n    name: product.name,\n    image: product.image,\n    price: product.price,\n    countInStock: product.countInStock,\n    qty\n  };\n  dispatch({\n    type: ADD_CART_ITEM,\n    payload: item\n  });\n};\nexport const removeCartItem = (dispatch, productId) => {\n  dispatch({\n    type: REMOVE_CART_ITEM,\n    payload: productId\n  });\n};\nexport const setProductDetail = async (dispatch, productId, qty) => {\n  dispatch({\n    type: BEGIN_PRODUCTS_REQUEST\n  });\n\n  try {\n    const product = await getProductById(productId);\n    if (qty === 0) dispatch({\n      type: SET_PRODUCT_DETAIL,\n      payload: {\n        product\n      }\n    });else dispatch({\n      type: SET_PRODUCT_DETAIL,\n      payload: {\n        product,\n        qty\n      }\n    });\n    dispatch({\n      type: SUCCESS_PRODUCTS_REQUEST\n    });\n  } catch (error) {\n    console.log(error);\n    dispatch({\n      type: FAIL_PRODUCTS_REQUEST,\n      payload: error\n    });\n  }\n};\nexport const setPage = async (dispatch, url, title) => {\n  let products = [];\n  dispatch({\n    type: BEGIN_PRODUCTS_REQUEST\n  });\n  dispatch({\n    type: SET_PAGE_TITLE,\n    payload: title\n  });\n\n  try {\n    products = await getProducts(url);\n    dispatch({\n      type: SET_PAGE_CONTENT,\n      payload: {\n        title,\n        products\n      }\n    });\n    dispatch({\n      type: SET_NAVBAR_ACTIVEITEM,\n      payload: url\n    });\n    dispatch({\n      type: SUCCESS_PRODUCTS_REQUEST\n    });\n  } catch (error) {\n    console.log(error);\n    dispatch({\n      type: FAIL_PRODUCTS_REQUEST,\n      payload: error\n    });\n  }\n};\nexport const login = async (dispatch, userInfo) => {\n  dispatch({\n    type: BEGIN_LOGIN_REQUEST\n  });\n\n  try {\n    const res = await signInWithEmailPassword(userInfo.email, userInfo.password);\n    console.log('after login ...');\n    console.log(res);\n\n    if (res.status === 200) {\n      dispatch({\n        type: SUCCESS_LOGIN_REQUEST,\n        payload: res.user\n      });\n      localStorage.setItem(\"userInfo\", JSON.stringify(res.user));\n      return res.user;\n    } else {\n      dispatch({\n        type: FAIL_LOGIN_REQUEST,\n        payload: `${res.status} error!\n        ${res.detail}`\n      });\n      return null;\n    }\n  } catch (e) {\n    console.log(e);\n    dispatch({\n      type: FAIL_LOGIN_REQUEST,\n      payload: e\n    });\n    console.log(e);\n    return null;\n  }\n};\nexport const register = async (dispatch, userInfo) => {\n  dispatch({\n    type: BEGIN_REGISTER_REQUEST\n  });\n\n  try {\n    const res = await registerWithEmailPassword(userInfo.email, userInfo.password, userInfo.username);\n\n    if (res.status === 200) {\n      dispatch({\n        type: SUCCESS_REGISTER_REQUEST,\n        payload: res.user\n      });\n      localStorage.setItem(\"userInfo\", JSON.stringify(res.user));\n      return res.user;\n    } else {\n      dispatch({\n        type: FAIL_REGISTER_REQUEST,\n        payload: `${res.status} error!\n        ${res.detail}`\n      });\n      return null;\n    }\n  } catch (e) {\n    dispatch({\n      type: FAIL_REGISTER_REQUEST,\n      payload: e\n    });\n    console.log(e);\n    return null;\n  }\n};\nexport const rememberLoginUser = (dispatch, remember) => {\n  dispatch({\n    type: REMEMBER_LOGIN,\n    payload: remember\n  });\n};\nexport const updateUserInfo = async (dispatch, userInfo) => {\n  dispatch({\n    type: BEGIN_UPDATE_USERINFO\n  });\n\n  try {\n    const res = await updateProfile(userInfo.username, userInfo.password, userInfo.address || \"\", userInfo.tel || \"\", userInfo.access_token, userInfo.user_id);\n\n    if (res.status === 200) {\n      dispatch({\n        type: SUCCESS_UPDATE_USERINFO,\n        payload: res.user\n      });\n      localStorage.setItem(\"userInfo\", JSON.stringify(res.user));\n      return res.user;\n    } else {\n      dispatch({\n        type: FAIL_UPDATE_USERINFO,\n        payload: `${res.status} error!\n        ${res.detail}`\n      });\n      return null;\n    }\n  } catch (e) {\n    dispatch({\n      type: FAIL_UPDATE_USERINFO,\n      payload: e\n    });\n    console.log(e);\n    return null;\n  }\n};\nexport const logout = async dispatch => {\n  dispatch({\n    type: LOGOUT_REQUEST\n  });\n  localStorage.removeItem(\"userInfo\");\n};\nexport const saveShippingAddress = (dispatch, shippingAddress) => {\n  dispatch({\n    type: SAVE_SHIPPING_ADDRESS,\n    payload: shippingAddress\n  });\n  localStorage.setItem('shippingAddress', JSON.stringify(shippingAddress));\n};\nexport const savePaymentMethod = (dispatch, paymentMethod) => {\n  dispatch({\n    type: SAVE_PAYMENT_METHOD,\n    payload: paymentMethod.paymentMethod\n  });\n};\nexport const createOrder = async (dispatch, cart, userInfo) => {\n  dispatch({\n    type: BEGIN_ORDER_CREATE\n  });\n\n  try {\n    const item = {\n      orderItems: cart.cartItems,\n      shippingAddress: cart.shippingAddress,\n      paymentMethod: cart.paymentMethod,\n      itemsPrice: cart.itemsPrice,\n      shippingPrice: cart.shippingPrice,\n      taxPrice: cart.taxPrice,\n      totalPrice: cart.totalPrice,\n      ...userInfo\n    };\n    const res = await createOrderApi(item, userInfo.access_token);\n\n    if (res.status === 200) {\n      dispatch({\n        type: SUCCESS_ORDER_CREATE,\n        payload: res.order\n      });\n      localStorage.setItem('orderInfo', JSON.stringify(res.order));\n      return res.order;\n    } else {\n      dispatch({\n        type: FAIL_ORDER_CREATE,\n        payload: `${res.status} error!\n        ${res.detail}`\n      });\n      return null;\n    }\n  } catch (error) {\n    console.log(error);\n    dispatch({\n      type: FAIL_ORDER_CREATE,\n      payload: error\n    });\n    return null;\n  }\n};\nexport const requestOrderDetail = async (dispatch, orderId) => {\n  dispatch({\n    type: BEGIN_ORDER_DETAIL\n  });\n\n  try {\n    const res = await getOrderById(orderId);\n\n    if (res.status === 200) {\n      dispatch({\n        type: SUCCESS_ORDER_DETAIL,\n        payload: res.order\n      });\n      localStorage.setItem(\"orderInfo\", JSON.stringify(res.order));\n      return res.order;\n    } else {\n      dispatch({\n        type: FAIL_ORDER_DETAIL,\n        payload: `${res.status} error!\n        ${res.detail}`\n      });\n      return null;\n    }\n  } catch (error) {\n    dispatch({\n      type: FAIL_ORDER_DETAIL,\n      payload: error\n    });\n  }\n};\nexport const resetOrder = dispatch => {\n  dispatch({\n    type: RESET_ORDER\n  });\n};","map":{"version":3,"sources":["/app/src/actions/index.js"],"names":["SET_PAGE_TITLE","SET_PAGE_CONTENT","SET_NAVBAR_ACTIVEITEM","ADD_CART_ITEM","REMOVE_CART_ITEM","SET_PRODUCT_DETAIL","BEGIN_PRODUCTS_REQUEST","SUCCESS_PRODUCTS_REQUEST","FAIL_PRODUCTS_REQUEST","BEGIN_LOGIN_REQUEST","SUCCESS_LOGIN_REQUEST","FAIL_LOGIN_REQUEST","BEGIN_REGISTER_REQUEST","SUCCESS_REGISTER_REQUEST","FAIL_REGISTER_REQUEST","BEGIN_UPDATE_USERINFO","SUCCESS_UPDATE_USERINFO","FAIL_UPDATE_USERINFO","LOGOUT_REQUEST","REMEMBER_LOGIN","BEGIN_ORDER_CREATE","SUCCESS_ORDER_CREATE","FAIL_ORDER_CREATE","SAVE_SHIPPING_ADDRESS","SAVE_PAYMENT_METHOD","RESET_ORDER","BEGIN_ORDER_DETAIL","SUCCESS_ORDER_DETAIL","FAIL_ORDER_DETAIL","getProducts","getProductById","signInWithEmailPassword","registerWithEmailPassword","updateProfile","createOrderApi","getOrderById","addCartItem","dispatch","product","qty","item","id","category","name","image","price","countInStock","type","payload","removeCartItem","productId","setProductDetail","error","console","log","setPage","url","title","products","login","userInfo","res","email","password","status","user","localStorage","setItem","JSON","stringify","detail","e","register","username","rememberLoginUser","remember","updateUserInfo","address","tel","access_token","user_id","logout","removeItem","saveShippingAddress","shippingAddress","savePaymentMethod","paymentMethod","createOrder","cart","orderItems","cartItems","itemsPrice","shippingPrice","taxPrice","totalPrice","order","requestOrderDetail","orderId","resetOrder"],"mappings":"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","sourcesContent":["import {\n  SET_PAGE_TITLE,\n  SET_PAGE_CONTENT,\n  SET_NAVBAR_ACTIVEITEM,\n  ADD_CART_ITEM,\n  REMOVE_CART_ITEM,\n  SET_PRODUCT_DETAIL,\n  BEGIN_PRODUCTS_REQUEST,\n  SUCCESS_PRODUCTS_REQUEST,\n  FAIL_PRODUCTS_REQUEST,\n  BEGIN_LOGIN_REQUEST,\n  SUCCESS_LOGIN_REQUEST,\n  FAIL_LOGIN_REQUEST,\n  BEGIN_REGISTER_REQUEST,\n  SUCCESS_REGISTER_REQUEST,\n  FAIL_REGISTER_REQUEST,\n  BEGIN_UPDATE_USERINFO,\n  SUCCESS_UPDATE_USERINFO,\n  FAIL_UPDATE_USERINFO,\n  LOGOUT_REQUEST,\n  REMEMBER_LOGIN,\n  BEGIN_ORDER_CREATE,\n  SUCCESS_ORDER_CREATE,\n  FAIL_ORDER_CREATE,\n  SAVE_SHIPPING_ADDRESS,\n  SAVE_PAYMENT_METHOD,\n  RESET_ORDER,\n  BEGIN_ORDER_DETAIL,\n  SUCCESS_ORDER_DETAIL,\n  FAIL_ORDER_DETAIL,\n} from \"../utils/constants\";\nimport {\n  getProducts,\n  getProductById,\n  signInWithEmailPassword,\n  registerWithEmailPassword,\n  updateProfile,\n  createOrderApi,\n  getOrderById,\n} from \"../api\";\nexport const addCartItem = (dispatch, product, qty) => {\n  const item = {\n    id: product.id,\n    category: product.category,\n    name: product.name,\n    image: product.image,\n    price: product.price,\n    countInStock: product.countInStock,\n    qty,\n  };\n  dispatch({\n    type: ADD_CART_ITEM,\n    payload: item,\n  });\n};\n\nexport const removeCartItem = (dispatch, productId) => {\n  dispatch({\n    type: REMOVE_CART_ITEM,\n    payload: productId,\n  });\n};\n\nexport const setProductDetail = async (dispatch, productId, qty) => {\n  dispatch({ type: BEGIN_PRODUCTS_REQUEST });\n  try {\n    const product = await getProductById(productId);\n    if (qty === 0)\n      dispatch({\n        type: SET_PRODUCT_DETAIL,\n        payload: {\n          product,\n        },\n      });\n    else\n      dispatch({\n        type: SET_PRODUCT_DETAIL,\n        payload: {\n          product,\n          qty,\n        },\n      });\n    dispatch({ type: SUCCESS_PRODUCTS_REQUEST });\n  } catch (error) {\n    console.log(error);\n    dispatch({ type: FAIL_PRODUCTS_REQUEST, payload: error });\n  }\n};\n\nexport const setPage = async (dispatch, url, title) => {\n  let products = [];\n  dispatch({ type: BEGIN_PRODUCTS_REQUEST });\n  dispatch({\n    type: SET_PAGE_TITLE,\n    payload: title,\n  });\n  try {\n    products = await getProducts(url);\n    dispatch({\n      type: SET_PAGE_CONTENT,\n      payload: { title, products },\n    });\n    dispatch({\n      type: SET_NAVBAR_ACTIVEITEM,\n      payload: url,\n    });\n    dispatch({ type: SUCCESS_PRODUCTS_REQUEST });\n  } catch (error) {\n    console.log(error);\n    dispatch({ type: FAIL_PRODUCTS_REQUEST, payload: error });\n  }\n};\n\nexport const login = async (dispatch, userInfo) => {\n  dispatch({ type: BEGIN_LOGIN_REQUEST });\n  try {\n    const res = await signInWithEmailPassword(\n      userInfo.email,\n      userInfo.password\n    );\n    console.log('after login ...')\n    console.log(res)\n    if (res.status === 200) {\n      dispatch({\n        type: SUCCESS_LOGIN_REQUEST,\n        payload: res.user,\n      });\n      localStorage.setItem(\"userInfo\", JSON.stringify(res.user));\n      return res.user;\n    } else {\n      dispatch({\n        type: FAIL_LOGIN_REQUEST,\n        payload: `${res.status} error!\n        ${res.detail}`,\n      });      \n      return null;\n    }\n\n  } catch (e) {\n    console.log(e);\n    dispatch({\n      type: FAIL_LOGIN_REQUEST,\n      payload: e,\n    });\n    console.log(e);\n    return null;\n  }\n};\n\nexport const register = async (dispatch, userInfo) => {\n  dispatch({ type: BEGIN_REGISTER_REQUEST });\n  try {\n    const res = await registerWithEmailPassword(\n      userInfo.email,\n      userInfo.password,\n      userInfo.username\n    );\n\n    if (res.status === 200) {\n      dispatch({\n        type: SUCCESS_REGISTER_REQUEST,\n        payload: res.user,\n      });\n      localStorage.setItem(\"userInfo\", JSON.stringify(res.user));\n      return res.user;\n    } else {\n      dispatch({\n        type: FAIL_REGISTER_REQUEST,\n        payload: `${res.status} error!\n        ${res.detail}`,\n      });\n      return null;\n    }\n  } catch (e) {\n    dispatch({\n      type: FAIL_REGISTER_REQUEST,\n      payload: e,\n    });\n    console.log(e);\n    return null;\n  }\n};\n\nexport const rememberLoginUser = (dispatch, remember) => {\n  dispatch({\n    type: REMEMBER_LOGIN,\n    payload: remember,\n  });\n};\n\nexport const updateUserInfo = async (dispatch, userInfo) => {\n  dispatch({ type: BEGIN_UPDATE_USERINFO });\n  try {\n    const res = await updateProfile(\n      userInfo.username,\n      userInfo.password,\n      userInfo.address || \"\",\n      userInfo.tel || \"\",\n      userInfo.access_token,\n      userInfo.user_id\n    );\n\n    if (res.status === 200) {\n      dispatch({\n        type: SUCCESS_UPDATE_USERINFO,\n        payload: res.user,\n      });\n      localStorage.setItem(\"userInfo\", JSON.stringify(res.user));\n      return res.user;\n    } else {\n      dispatch({\n        type: FAIL_UPDATE_USERINFO,\n        payload: `${res.status} error!\n        ${res.detail}`,\n      });\n      return null;\n    }\n  } catch (e) {\n    dispatch({\n      type: FAIL_UPDATE_USERINFO,\n      payload: e,\n    });\n    console.log(e);\n    return null;\n  }\n};\n\nexport const logout = async (dispatch) => {\n  dispatch({ type: LOGOUT_REQUEST });\n  localStorage.removeItem(\"userInfo\");\n};\n\nexport const saveShippingAddress = (dispatch, shippingAddress) => {\n  dispatch({\n    type: SAVE_SHIPPING_ADDRESS,\n    payload: shippingAddress,\n  });\n  localStorage.setItem('shippingAddress', JSON.stringify(shippingAddress));\n}\n\nexport const savePaymentMethod = (dispatch, paymentMethod) => {\n  dispatch({\n    type: SAVE_PAYMENT_METHOD,\n    payload: paymentMethod.paymentMethod,\n  });\n}\n\n\nexport const createOrder = async (dispatch, cart, userInfo) => {\n  dispatch({ type: BEGIN_ORDER_CREATE });\n  try {\n    const item = {\n      orderItems: cart.cartItems,\n      shippingAddress: cart.shippingAddress,\n      paymentMethod: cart.paymentMethod,\n      itemsPrice: cart.itemsPrice,\n      shippingPrice: cart.shippingPrice,\n      taxPrice: cart.taxPrice,\n      totalPrice: cart.totalPrice,\n      ...userInfo\n    };    \n    const res = await createOrderApi(item, userInfo.access_token);\n\n    if (res.status === 200) {\n      dispatch({ \n        type: SUCCESS_ORDER_CREATE, \n        payload: res.order \n      });\n      localStorage.setItem('orderInfo', JSON.stringify(res.order));\n      return res.order;\n    } else {\n      dispatch({\n        type: FAIL_ORDER_CREATE,\n        payload: `${res.status} error!\n        ${res.detail}`,\n      });\n      return null;\n    }\n    \n  } catch (error) {\n    console.log(error);\n    dispatch({ type: FAIL_ORDER_CREATE, payload: error });\n    return null;\n  }  \n}\n\nexport const requestOrderDetail = async (dispatch, orderId) => {\n  dispatch({ type: BEGIN_ORDER_DETAIL });\n  try {\n \n    const res = await getOrderById(orderId);\n\n    if (res.status === 200) {\n      dispatch({\n        type: SUCCESS_ORDER_DETAIL,\n        payload: res.order,\n      });\n      localStorage.setItem(\"orderInfo\", JSON.stringify(res.order));\n      return res.order;\n    } else {\n      dispatch({\n        type: FAIL_ORDER_DETAIL,\n        payload: `${res.status} error!\n        ${res.detail}`,\n      });\n      return null;\n    }\n  } catch (error) {\n    dispatch({\n      type: FAIL_ORDER_DETAIL,\n      payload: error,\n    });\n  }\n};\n\nexport const resetOrder = (dispatch) => {\n  dispatch({ type: RESET_ORDER });\n};"]},"metadata":{},"sourceType":"module"}